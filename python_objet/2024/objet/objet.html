<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Objet :: Supports</title>
    <link rel="canonical" href="https://jacquelincharbonnel.github.io/supports/python_objet/2024/objet/objet.html">
    <meta name="generator" content="Antora 3.1.14">
    <link rel="stylesheet" href="../../../_/css/site.css">
<!-- reference des feuilles de styles suppl√©mentaires -->
<link rel="stylesheet" href="../../../_/css/layout.css">
<link rel="stylesheet" href="../../../_/css/content.css">

  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://jacquelincharbonnel.github.io/supports">Supports</a>
  <!-- suppression du burger du bandeau
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
-->      
    </div>
<!-- suppression des boutons du bandeau
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
      </div>
    </div>
-->
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="python_objet" data-version="2024">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <button class="nav-menu-toggle" aria-label="Toggle expand/collapse all" style="display: none"></button>
    <h3 class="title"><a href="../index.html">Python objet</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../poo/poo.html">Concepts de la POO</a>
  </li>
  <li class="nav-item is-current-page" data-depth="1">
    <a class="nav-link" href="objet.html">Objet</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../operateurs/operateurs.html">Op√©rateurs</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../classe/classe.html">Membres de classe</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../heritage/heritage.html">H√©ritage</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../exception/exception.html">Exceptions</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Applications</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../app_iter/iter.html">It√©rable</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../app_files/files.html">Lecture/√©criture de donn√©es</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../app_contextman/context.html">Context manager</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../app_serialisation/serialisation.html">S√©rialisation</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../app_callable/callable.html">Callables</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Python objet</span>
    <span class="version">2024</span>
  </div>
  <ul class="components">
    <li class="component">
      <div class="title"><a href="../../../C/2023/index.html">C</a></div>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../C/2023/index.html">2023</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <div class="title"><a href="../../../concurrence/2024/index.html">Concurrence</a></div>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../concurrence/2024/index.html">2024</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <div class="title"><a href="../../../json/2023/index.html">JSON</a></div>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../json/2023/index.html">2023</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <div class="title"><a href="../../../linux_context/2025/index.html">Linux contexte</a></div>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../linux_context/2025/index.html">2025</a>
        </li>
      </ul>
    </li>
    <li class="component is-current">
      <div class="title"><a href="../index.html">Python objet</a></div>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../index.html">2024</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <div class="title"><a href="../../../supports/index.html">Supports</a></div>
    </li>
    <li class="component">
      <div class="title"><a href="../../../xml/2023/index.html">XML</a></div>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../xml/2023/index.html">2023</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../../../supports/index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../index.html">Python objet</a></li>
    <li><a href="objet.html">Objet</a></li>
  </ul>
</nav>
<!-- supression de "edit this page"
  <div class="edit-this-page"><a href="file:///home/jaclin/antora_components/python_objet/./modules/objet/pages/objet.adoc">Edit this Page</a></div>
-->
</div>
  <!-- ajout de la date de modification -->
     <div class="lastmodify"> derni√®re modification : 2024 </div>
  <!-- fin ajout -->
  <div class="content">
<aside class="toc sidebar" data-title="Plan" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">Objet</h1>
<div class="sect1">
<h2 id="_classe"><a class="anchor" href="#_classe"></a>1. Classe</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Une classe d√©finit un type d‚Äôobjets.
Une classe <code>C</code> se d√©finit dans un fichier source <code>C.py</code>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
D√©finir une classe dans son propre fichier source est une r√®gle de <em>bonne</em> pratique,
qu&#8217;il est important de suivre, surtout lorsque l&#8217;on d√©bute.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Par exemple, pour mod√©liser les nombres complexes,
on commence par cr√©er une classe <code>Complex</code> dans un fichier <code>Complex.py</code> :</p>
</div>
<div class="listingblock">
<div class="title">fichier <code>Complex.py</code></div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">class Complex:
  pass</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Le nom d&#8217;une classe commence par une majuscule.
C&#8217;est l√† encore une convention qu&#8217;il est fortement conseill√© de respecter
(cf <a href="https://www.python.org/dev/peps/pep-0008/">PEPS 8</a>).
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_instance"><a class="anchor" href="#_instance"></a>2. Instance</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Utiliser une classe <code>C</code> se fait hors du fichier <code>C.py</code>, dans un autre fichier qui l&#8217;aura import√© (comme on l&#8217;aurait fait pour un module).</p>
</div>
<div class="paragraph">
<p>Utiliser une classe, c&#8217;est d&#8217;abord cr√©er des instances.
Par exemple, instancier la classe <code>Complex</code>, c&#8217;est cr√©er des objets de type <code>Complex</code> :</p>
</div>
<div class="listingblock">
<div class="title">fichier main.py</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">#!/bin/env python3
from Complex import Complex

z1 = Complex()
z2 = Complex()</code></pre>
</div>
</div>
<div class="paragraph">
<p>On peut ensuite initialiser ces 2 objets :</p>
</div>
<div class="listingblock">
<div class="title">fichier main.py</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">...
z1.x = 1
z1.y = 2
print(z1)          # &lt;__main__.Complex object at 0x7fd643130fec&gt;

z2.x = 0
z2.y = -1
print(z2)          # &lt;__main__.Complex object at 0x7fdfec643130&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Le code ci-dessus cr√©e et initialise 2 attributs <code>x</code> et <code>y</code> (la partie r√©elle et la partie imaginaire) pour chaque instance.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Par d√©finition, l&#8217;√©tat d&#8217;un objet (√† un instant donn√©), c&#8217;est l&#8217;ensemble des valeurs de tous ses attributs.
Donc ici, l&#8217;√©tat de <code>z1</code> c&#8217;est <code>{x:1,y:2}</code>,
et l&#8217;√©tat de <code>z2</code> c&#8217;est <code>{x:0,y:-1}</code>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>On peut ensuite calculer le module et l&#8217;argument d&#8217;un complexe avec 2 fonctions :</p>
</div>
<div class="listingblock">
<div class="title">fichier main.py</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">#!/bin/env python3
from Complex import Complex

def module(z):
  return math.sqrt(z.x**2 + z.y**2)      ‚ö†Ô∏è <i class="conum" data-value="1"></i><b>(1)</b>

def argument(z):
  return math.atan(z.y/z.x)              ‚ö†Ô∏è <i class="conum" data-value="1"></i><b>(1)</b>

z = Complex()
z.x = 1                                  ‚ö†Ô∏è <i class="conum" data-value="1"></i><b>(1)</b>
z.y = 2                                  ‚ö†Ô∏è <i class="conum" data-value="1"></i><b>(1)</b>
print(module(z))
print(argument(z))</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>‚ö†Ô∏è Acc√®s aux attributs <code>x</code> et <code>y</code> depuis l&#8217;ext√©rieur de l&#8217;objet, √† √©viter !</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Une bonne pratique en POO est de ne pas acc√©der, de l&#8217;ext√©rieur d&#8217;un objet, √† ses attributs.
Il est clair que l&#8217;exemple pr√©c√©dent ne respecte pas cette r√®gle de bonne pratique. &#x1F615;</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_m√©thode"><a class="anchor" href="#_m√©thode"></a>3. M√©thode</h2>
<div class="sectionbody">
<div class="paragraph">
<p>On peut encapsuler une fonction dans un objet.
La fonction ainsi encapsul√©e s&#8217;appelle une m√©thode.
Encapsuler les 2 fonctions <code>module()</code> et <code>argument()</code> pr√©c√©dentes donne :</p>
</div>
<div class="listingblock">
<div class="title">fichier Complex.py</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">import math

class Complex:
  def module(z):
    return math.sqrt(z.x**2 + z.y**2)  üëç <i class="conum" data-value="1"></i><b>(1)</b>

  def argument(z):
    return math.atan(z.y/z.x)          üëç <i class="conum" data-value="1"></i><b>(1)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>La m√©thode faisant partie int√©grante de l&#8217;objet, elle acc√©de aux attributs de l&#8217;objet sans violer les pr√©ceptes de la POO.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>On appelle ces m√©thodes de la fa√ßon suivante :</p>
</div>
<div class="listingblock">
<div class="title">fichier main.py</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">#!/bin/env python3
from Complex import Complex

z = Complex()
z.x = 1                        ‚ö†Ô∏è
z.y = 2                        ‚ö†Ô∏è
print(Complex.module(z))       <i class="conum" data-value="1"></i><b>(1)</b>
print(Complex.argument(z))     <i class="conum" data-value="1"></i><b>(1)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>on sp√©cifie que la fonction appartient √† <code>Complex</code></td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Par d√©finition, les attributs et m√©thodes d&#8217;un objet ou d&#8217;une classe
sont appell√©s indistinctement <em>membres</em> de l&#8217;objet ou de la classe.
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="_appeler_une_m√©thode"><a class="anchor" href="#_appeler_une_m√©thode"></a>3.1. Appeler une m√©thode</h3>
<div class="paragraph">
<p><code>Complex.module(z)</code> peut s&#8217;√©crire plus simplement <code>z.module()</code>,
donc le code pr√©c√©dent s&#8217;√©crit plus clairement :</p>
</div>
<div class="listingblock">
<div class="title">fichier main.py</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">#!/bin/env python3
from Complex import Complex

z = Complex()
z.x = 1                                  ‚ö†Ô∏è
z.y = 2                                  ‚ö†Ô∏è
print(z.module())                        # appel de m√©thode
print(z.argument())                      # appel de m√©thode</code></pre>
</div>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
Soit <code>x</code> une instance et <code>f</code> une m√©thode,
l&#8217;appel <code>x.f()</code> est interpr√©t√© comme <code>f(x)</code>.
Plus g√©n√©ralement, l&#8217;appel
<code>x.f(a,b)</code> est interpr√©t√© comme <code>f(x,a,b)</code>.
Par cons√©quent, le nombre de param√®tres d&#8217;une m√©thode est √©gal au nombre d&#8217;arguments +1.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_cr√©er_des_m√©thodes_pour_acc√©der_aux_attributs"><a class="anchor" href="#_cr√©er_des_m√©thodes_pour_acc√©der_aux_attributs"></a>3.2. Cr√©er des m√©thodes pour acc√©der aux attributs</h3>
<div class="paragraph">
<p>Pour faire disparaitre les 2 instructions restantes qui acc√®dent directement aux attributs <code>x</code> et <code>y</code>,
il suffit de cr√©er une nouvelle m√©thode qui r√©alise cette initialisation :</p>
</div>
<div class="listingblock">
<div class="title">fichier Complex.py</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">import math

class Complex:
  def initialise(z,reel,imag):
    z.x = reel
    z.y = imag

  def module(z):
    return math.sqrt(z.x**2 + z.y**2)

  def argument(z):
    return math.atan(z.y/z.x)</code></pre>
</div>
</div>
<div class="paragraph">
<p>Avec cela, on peut √©crire un programme dans les r√®gles de l&#8217;art :</p>
</div>
<div class="listingblock">
<div class="title">fichier main.py</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">#!/bin/env python3
from Complex import Complex

z1 = Complex()
z1.initialise(1,2)

z2 = Complex()
z2.initialise(2,-1)

print(z1.module())
print(z2.argument())</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_self"><a class="anchor" href="#_self"></a>3.3. <code>self</code></h3>
<div class="paragraph">
<p>Il est de coutume de nommer <code>self</code> le premier param√®tre de chaque methode,
ce qui donne au final :</p>
</div>
<div class="listingblock">
<div class="title">fichier Complex.py</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">import math

class Complex:
  def initialise(self,reel,imag):
    self.x = reel
    self.y = imag

  def module(self):
    return math.sqrt(self.x**2 + self.y**2)

  def argument(self):
    return math.atan(self.y/self.x)</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_lencapsulation"><a class="anchor" href="#_lencapsulation"></a>3.4. L&#8217;encapsulation</h3>
<div class="paragraph">
<p>L&#8217;encapsulation, concept important en programmation orient√©e objet,
consiste √† rassembler donn√©es et services associ√©s au sein d&#8217;une structure <em>boite noire</em> ou <em>capsule spaciale</em> : l&#8217;objet.
De l&#8217;ext√©rieur de l&#8217;objet, il n&#8217;est pas souhaitable d&#8217;acc√©der √† ses attributs.
De l&#8217;ext√©rieur, on ne doit utiliser que ses m√©thodes (qui elles acc√®dent aux attributs).</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Suivant les langages de programmation, plusieurs niveaux de contr√¥le d&#8217;accessibilit√© existent.
Par exemple, C++ dispose de notion de membres priv√©s, <em>prot√©g√©s</em> et publics.
Les membres sont priv√©s par d√©faut :
seul le concepteur de la classe y acc√®de.
Les membres prot√©g√©s sont accessibles au concepteur et aux h√©ritiers de la classe,
mais pas aux utilisateurs (ceux qui cr√©ent des instances).
Et les membres publics sont accessibles √† tous.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Python ne propose pas de contr√¥le d&#8217;accessibilit√© : tous les membres sont publics.
Il existe juste une convention qui stipule que tout membre
dont le nom commence par <code>_</code> doit √™tre consid√©r√© comme priv√©.
Par exemple :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">class Complex:
  def initialise(self,x,y):
    self._x = x
    self._y = y
  ...</code></pre>
</div>
</div>
<div class="paragraph">
<p>met en √©vidence que <code>_x</code> et <code>_y</code> sont priv√©s,
et que, par cons√©quent, √©crire :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">z = Complex()
print(z._x,z._y)   # oulala, ce n'est pas bien !</code></pre>
</div>
</div>
<div class="paragraph">
<p>n&#8217;est pas conforme aux pr√©ceptes de la POO.
Rien de plus : rien n&#8217;emp√™che de passer outre.
Plus radical consiste √† pr√©fixer le nom du membre
par <code>__</code> :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">class Complex:
  def initialise(self,x,y):
    self.__x = x
    self.__y = y
  ...
z = Complex()
print(z.__x,z.__y)   # ‚õî ‚õî</code></pre>
</div>
</div>
<div class="paragraph">
<p>Cette fois-ci, le programme sort :</p>
</div>
<div class="listingblock">
<div class="content">
<pre>AttributeError: 'Complex' object has no attribute '__x'
AttributeError: 'Complex' object has no attribute '__y'</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_r√©capitulatif"><a class="anchor" href="#_r√©capitulatif"></a>3.5. R√©capitulatif</h3>
<div class="paragraph">
<p>Les membres d&#8217;un objet sont ses attributs et ses m√©thodes.
Une m√©thode est une fonction interne √† l&#8217;objet, destin√©e √† intervenir sur ses attributs.
L&#8217;ensemble des m√©thodes d&#8217;un objet impl√©mente son comportement,
au m√™me titre que ses attributs impl√©mentent son √©tat.
Toute m√©thode poss√®de au moins un param√®tre
destin√© √† recevoir l&#8217;objet pour lequel elle est appel√©e (c&#8217;est le premier de la liste) .
La convention est de le nommer <code>self</code>.
<code>self</code> re√ßoit donc l&#8217;objet courant, qui permet √† la m√©thode d&#8217;acc√©der √† tous ses membres.</p>
</div>
<div class="paragraph">
<p>Hors de la classe, dans le programme principal,
√©crire <code>z.module()</code> (o√π <code>z</code> est une instance de la classe <code>Complex</code>) n&#8217;est qu&#8217;une mani√®re √©l√©gante d&#8217;√©crire <code>Complex.module(z)</code>.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Pour une classe <code>C</code>, bien noter les 2 acteurs :</p>
</div>
<div class="ulist">
<ul>
<li>
<p>le concepteur de la classe, qui g√®re le code du fichier <code>C.py</code>,
et qui par cons√©quent, dispose d&#8217;un acc√®s total aux entrailles des objets de type <code>C</code>,</p>
</li>
<li>
<p>l&#8217;utilisateur de la classe, qui cr√©e des instances de <code>C</code> sans connaitre les d√©tails de l&#8217;impl√©mentation : il importe le fichier <code>C.py</code> sans connaitre son contenu (pas de n√©cessit√© pour lui d&#8217;y jeter un oeil, et encore moins de le modifier).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Pour mettre au point une classe, le codeur prend alternativement le r√¥le de concepteur et d&#8217;utilisateur (classe cr√©√©e par le concepteur, test√©e par l&#8217;utilisateur, corrig√©e par le concepteur, etc.)</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_membres_pr√©d√©finis"><a class="anchor" href="#_membres_pr√©d√©finis"></a>4. Membres pr√©d√©finis</h2>
<div class="sectionbody">
<div class="paragraph">
<p>De base, un objet dispose de membres pr√©-existants.
Ceux-ci sont facilement reconnaissables, car leur nom est de la forme <code>__xxx__</code>.</p>
</div>
<div class="paragraph">
<p><code>__class__</code>,
<code>__name__</code>,
<code>__dict__</code>,
<code>__doc__</code>
sont des exemples d&#8217;attributs pr√©existants.</p>
</div>
<div class="paragraph">
<p><code>__init__()</code>,
<code>__new__()</code>,
<code>__str__()</code>
sont des exemples de m√©thodes pr√©existantes.
Elles r√©alisent un traitement par d√©faut, et sont automatiquement appel√©es tout au long de l&#8217;existance de l&#8217;objet.
Mais le programmeur peut les red√©finir (les <em>surcharger</em>) pour personnaliser leur action.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Cette forme de nom alambiqu√©e (un nom encadr√© par 2 doubles underscores) est courante en Python.
Elle a pour but de minimiser le risque de collision avec ce que le programmeur peut choisir comme noms pour ses cr√©ations
(en g√©n√©ral, le d√©veloppeur ne choisit pas de nom de cette forme).
On les surnomme les  <em>dunders</em> (<strong>D</strong>ouble <strong>UNDER</strong>scores).</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Exemple :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">class C:
  """
    Ceci est classe vide
  """
  pass

if __name__=="__main__":
  c = C()
  print(f"{c.__class__.__name__=}\n",
        f"{c.__dict__=}\n",
        f"{c.__init__=}\n",
        f"{c.__doc__=}\n",
        f"{dir(c)=}")                  <i class="conum" data-value="1"></i><b>(1)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>La fonction <code>dir()</code> liste les membres de l&#8217;objet pass√© en argument.</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="_constructeur"><a class="anchor" href="#_constructeur"></a>4.1. Constructeur</h3>
<div class="paragraph">
<p>Le constructeur d&#8217;une classe est une m√©thode particuli√®re nomm√©e <code>__init__()</code>.</p>
</div>
<div class="paragraph">
<p>Si elle existe, alors elle est automatiquement appel√©e √† la cr√©ation
de chaque instance.
Son but est d‚Äôinitialiser l‚Äôobjet en cours de cr√©ation.</p>
</div>
<div class="listingblock">
<div class="title">fichier <code>Complex.py</code></div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">import math

class Complex:
  def __init__(self,reel,imag):
    """Constructeur de la classe"""
    self.x = reel
    self.y = imag

  def module(self):
    return math.sqrt(self.x**2 + self.y**2)

  def argument(self):
    return math.atan(self.y/self.x)</code></pre>
</div>
</div>
<div class="paragraph">
<p>Cr√©er un constructeur avec param√®tres contraint l&#8217;instanciation :</p>
</div>
<div class="listingblock">
<div class="title">fichier <code>main.py</code></div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">from Complex import Complex

z = Complex()     # TypeError: __init__() takes exactly 3 arguments (1 given)
z = Complex(1,2)  # Ok, 2 arguments sont maintenant obligatoires</code></pre>
</div>
</div>
<div class="paragraph">
<p>On constate qu&#8217;il n&#8217;est maintenant plus possible de cr√©er des complexes sans les initialiser.
C&#8217;est un avantage : les variables non initialis√©es sont des bombes √† retardement.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p><em>Constructeur</em> (<em>constructor</em>) n&#8217;est pas le terme le mieux choisi pour nommer la m√©thode <code>__init__()</code>, car celle-ci ne cr√©e pas l&#8217;objet, elle l&#8217;initialise.
Mais c&#8217;est le terme consacr√© dans la plupart des langages √† objet.
<em>Initialisateur</em> serait plus pertinent
(car le v√©ritable constructeur en python est la m√©thode <code>__new__</code>).</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_destructeur"><a class="anchor" href="#_destructeur"></a>4.2. Destructeur</h3>
<div class="paragraph">
<p>Sym√©triquement, le destructeur d&#8217;une classe est une m√©thode particuli√®re nomm√©e <code>__del__()</code>.</p>
</div>
<div class="paragraph">
<p>Si elle existe, alors elle est automatiquement appel√©e √† la destruction
de chaque instance.
Son but est d‚Äôoffrir une derni√®re occasion de restaurer proprement l&#8217;environnement avant la disparition de l‚Äôobjet :
fermer un fichier qui a √©t√© ouvert au pr√©alable,
lib√©rer une ressource allou√©e auparavant,
etc.</p>
</div>
</div>
<div class="sect2">
<h3 id="_s√©rialisation"><a class="anchor" href="#_s√©rialisation"></a>4.3. S√©rialisation</h3>
<div class="paragraph">
<p>La s√©rialisation est le codage d‚Äôune information dans un format qui peut √™tre facilement conserv√© et partag√©.
La s√©rialisation au format texte d&#8217;un objet est sa repr√©sentation sous forme de cha√Æne de caract√®res.
Un objet qui poss√®de, par nature, une existence cantonn√©e √† la m√©moire volatile de l‚Äôordinateur, peut, via la s√©rialisation, s&#8217;en √©vader.
L&#8217;objet peut ainsi √©chapper √† l&#8217;application qui l&#8217;a cr√©√©, et persister au-del√† de l&#8217;ex√©cution de cette application :
il peut √™tre sauvegard√© sur disque (et √™tre restaur√© par la suite, dans une autre application),
ou bien envoy√© sur le r√©seau (pour √™tre r√©cup√©r√© et ressuscit√© √† l&#8217;autre bout).
Sa dur√©e de vie d√©passe ainsi celle de l‚Äôapplication qui l‚Äôa cr√©√©.
On appelle cela un objet <em>persistant</em>.</p>
</div>
<div class="paragraph">
<p>L&#8217;op√©ration inverse, qui consiste, √† partir d&#8217;une repr√©sentation textuelle, √† recr√©er l&#8217;objet dans la m√©moire de l&#8217;ordinateur,
s&#8217;appelle la <em>d√©s√©rialisation</em>.</p>
</div>
<div class="paragraph">
<p>Par exemple, le complexe <code>1+2i</code> peut √™tre s√©rialiser en <code>"Complex(1,2)"</code>.
Pour le conserver ou l&#8217;exp√©dier, il suffit de sauvegarder ou d&#8217;envoyer sur le r√©seau cette cha√Æne de caract√®res.</p>
</div>
<div class="exampleblock">
<div class="title">Remarque</div>
<div class="content">
<div class="paragraph">
<p>S√©rialiser n&#8217;est pas toujours aussi simple.
Par exemple, comment s√©rialiser <code>l2</code> d√©finie par :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">l1 = [1,2,3]
l2  = [l1,l1]</code></pre>
</div>
</div>
<div class="paragraph">
<p>et repr√©sentable comme :</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/seri1.png" alt="seri1">
</div>
</div>
<div class="paragraph">
<p>et diff√©rente de l3 d√©finie par :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">l3 = [[1,2,3],[1,2,3]]</code></pre>
</div>
</div>
<div class="paragraph">
<p>et repr√©sentable comme :</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/seri2.png" alt="seri2">
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_la_m√©thode_repr"><a class="anchor" href="#_la_m√©thode_repr"></a>4.3.1. La m√©thode <code>__repr__()</code></h4>
<div class="paragraph">
<p>La fonction <code>repr()</code> appliqu√©e √† un objet est cens√©e renvoyer sa s√©rialisation au format cha√Æne de caract√®res :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">z = Complex(1,2)
  z_serial = repr(z)
print(z_serial)  # -&gt; &lt;__main__.Complex object at 0x7f9def1860f0&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Le r√©sultat n&#8217;est pas convainquant, mais on peut le personnaliser
en red√©finissant la m√©thode <code>__repr__()</code> :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">class Complex;
  ...
  def __repr__(self):
    return f"Complex({self.x},{self.y}")

if __name__ == "__main__":
  z = Complex(1,2)
  z_serial = repr(z)
  print(z_serial)  # -&gt; Complex(1,2)</code></pre>
</div>
</div>
<div class="paragraph">
<p>Pour d√©s√©rialiser l&#8217;objet, il suffit de faire :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">z = eval(z_serial)</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_la_m√©thode_str"><a class="anchor" href="#_la_m√©thode_str"></a>4.3.2. La m√©thode <code>__str__()</code></h4>
<div class="paragraph">
<p>A l&#8217;instar de <code>repr()</code>, la fonction <code>str()</code> appliqu√©e √† un objet est cens√©e en donner une repr√©sentation au format cha√Æne de caract√®res, sans avoir autant d&#8217;exigence :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">z = Complex(1,2)
print(str(z))  # -&gt; &lt;__main__.Complex object at 0x7f9def1860f0&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Le r√©sultat n&#8217;est pas plus convainquant que pr√©c√©demment,
<code>__str__</code> ayant pour valeur par d√©faut <code>__repr__</code>.
Mais l√† encore, on peut le personnaliser
en red√©finissant la m√©thode <code>__str__()</code>.</p>
</div>
<div class="paragraph">
<p>La cha√Æne renvoy√©e par <code>str()</code> n&#8217;a pas pour but de recr√©er l&#8217;objet, mais simplement de le repr√©senter de fa√ßon univoque.
Et Python utilisera automatiquement (sans avertissement) cette fonction <code>str()</code> pour convertir un objet en string :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">class Complex:
  ...
  def __str__(self):
    return f"{self.x}+{self.y}i")

if __name__ == "__main__":
  z = Complex(1,2)
  print(z)  # -&gt; 1+2i</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>str()</code> est utilis√© par Python √† chaque fois qu&#8217;il y a necessit√© de convertir un objet en string.
Et en particulier, <code>print(objet)</code> est interpr√©t√© comme <code>print(str(objet))</code>,
comme le montre l&#8217;exemple ci-dessus.</p>
</div>
<div class="paragraph">
<p><code>repr()</code> et <code>str()</code> sont donc cens√©es renvoyer toutes les 2 une caract√©risation de l&#8217;objet sous forme d&#8217;une cha√Æne de caract√®res.
Celle fournit par <code>str()</code> est plut√¥t destin√©e √† des humains
(la chaine renvoy√©e doit √™tre humainement compr√©hensible),
alors que celle fournit par <code>repr()</code> est plut√¥t √† destination des programmes,
comme essaie de l&#8217;expliquer la doc de Python.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">extrait de <a href="https://docs.python.org/fr/3/reference/datamodel.html#object.&#95;&#95;repr&#95;&#95;">la doc Python</a></div>
<div class="paragraph">
<p><code>__repr__()</code>
doit renvoyer la repr√©sentation ¬´ officielle ¬ª en cha√Æne de caract√®res d&#8217;un objet.
Tout est fait pour que celle-ci ressemble √† une expression Python valide pouvant √™tre utilis√©e pour recr√©er un objet avec la m√™me valeur (dans un environnement donn√©).
La valeur renvoy√©e doit √™tre un objet cha√Æne de caract√®res.
Si une classe d√©finit <code>__repr__()</code> mais pas <code>__str__()</code>,
alors <code>__repr__()</code> est aussi utilis√©e quand une repr√©sentation ¬´ informelle ¬ª en cha√Æne de caract√®res est demand√©e pour une instance de cette classe.</p>
</div>
<div class="paragraph">
<p>Cette fonction √©tant principalement utilis√©e √† des fins de d√©bogage, il est donc important que la repr√©sentation donne beaucoup d&#8217;informations et ne soit pas ambig√ºe.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">extrait de <a href="https://docs.python.org/fr/3/reference/datamodel.html#object.&#95;&#95;str&#95;&#95;">la doc Python</a></div>
<div class="paragraph">
<p><code>__str__()</code>
doit renvoyer une cha√Æne de caract√®res ¬´ informelle ¬ª ou joliment mise en forme de repr√©sentation de l&#8217;objet. La valeur renvoy√©e doit √™tre un objet string.</p>
</div>
<div class="paragraph">
<p>Cette m√©thode diff√®re de <code>__repr__()</code> car il n&#8217;est pas attendu que <code>__str__()</code> renvoie une expression Python valide : une repr√©sentation plus agr√©able √† lire ou plus concise peut √™tre utilis√©e.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Ainsi dans l&#8217;exemple pr√©c√©dent, pour <code>z=Complex(1,2)</code>, <code>str(z)</code> renvoie la string <code>"1+2i"</code>,
alors que <code>repr(z)</code> renvoie la string <code>"Complex(1,2)"</code>.</p>
</div>
</div>
</div>
</div>
</div>
</article>
  </div>
</main>
</div>
<footer class="footer">
  <p class="center">
  <span style="font-size: 0.9em;">
    <a href="https://jacquelincharbonnel.github.io/">Jacquelin Charbonnel</a>
    <!-- &nbsp; &mdash; &nbsp; -->
    &nbsp;
    &copy;Creative Commons BY-NC-SA 4.0
  </span>
  </p>
</footer>

<script>
var myDate = new Date(document.lastModified);
myNewDate = new Intl.DateTimeFormat(
            undefined,
            {year: "numeric", month: "long", day: "numeric", hour: "2-digit", minute: "2-digit"}
        )
        .format(myDate).replace(/\./g, '-');
document.getElementById("lastmodify").innerHTML = myNewDate ;
</script>

<script id="site-script" src="../../../_/js/site.js" data-ui-root-path="../../../_"></script>
<script async src="../../../_/js/vendor/highlight.js"></script>
  </body>
</html>
