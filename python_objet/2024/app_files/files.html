<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Lecture/écriture de données :: supports</title>
    <link rel="canonical" href="https://jacquelincharbonnel.github.io/supports/python_objet/2024/app_files/files.html">
    <meta name="generator" content="Antora 3.1.14">
    <link rel="stylesheet" href="../../../_/css/site.css">
<!-- reference des feuilles de styles supplémentaires -->
<link rel="stylesheet" href="../../../_/css/layout.css">
<link rel="stylesheet" href="../../../_/css/content.css">

  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://jacquelincharbonnel.github.io/supports">supports</a>
  <!-- suppression du burger du bandeau
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
-->      
    </div>
<!-- suppression des boutons du bandeau
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
      </div>
    </div>
-->
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="python_objet" data-version="2024">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <button class="nav-menu-toggle" aria-label="Toggle expand/collapse all" style="display: none"></button>
    <h3 class="title"><a href="../index.html">Python objet</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../poo/poo.html">Concepts de la POO</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../objet/objet.html">Objet</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../operateurs/operateurs.html">Opérateurs</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../classe/classe.html">Membres de classe</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../heritage/heritage.html">Héritage</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../exception/exception.html">Exceptions</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Applications</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../app_iter/iter.html">Itérable</a>
  </li>
  <li class="nav-item is-current-page" data-depth="2">
    <a class="nav-link" href="files.html">Lecture/écriture de données</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../app_contextman/context.html">Context manager</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../app_serialisation/serialisation.html">Sérialisation</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../app_callable/callable.html">Callables</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Python objet</span>
    <span class="version">2024</span>
  </div>
  <ul class="components">
    <li class="component">
      <div class="title"><a href="../../../C/2023/index.html">C</a></div>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../C/2023/index.html">2023</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <div class="title"><a href="../../../concurrence/2024/index.html">Concurrence</a></div>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../concurrence/2024/index.html">2024</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <div class="title"><a href="../../../linux_context/2025/index.html">Linux contexte</a></div>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../linux_context/2025/index.html">2025</a>
        </li>
      </ul>
    </li>
    <li class="component is-current">
      <div class="title"><a href="../index.html">Python objet</a></div>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../index.html">2024</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <div class="title"><a href="../../../supports/index.html">Supports</a></div>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../../../supports/index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../index.html">Python objet</a></li>
    <li>Applications</li>
    <li><a href="files.html">Lecture/écriture de données</a></li>
  </ul>
</nav>
<!-- supression de "edit this page"
  <div class="edit-this-page"><a href="file:///home/jaclin/antora_components/python_objet/./modules/app_files/pages/files.adoc">Edit this Page</a></div>
-->
</div>
  <!-- ajout de la date de modification -->
     <div class="lastmodify"> dernière modification : 2024 </div>
  <!-- fin ajout -->
  <div class="content">
<aside class="toc sidebar" data-title="Plan" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">Lecture/écriture de données</h1>
<div class="sect1">
<h2 id="_données_textuelles"><a class="anchor" href="#_données_textuelles"></a>1. Données textuelles</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_format_texte"><a class="anchor" href="#_format_texte"></a>1.1. Format texte</h3>
<div class="paragraph">
<p>Des données sont textuelles si elles sont humainement lisibles,
c&#8217;est-à-dire si elles se visualisent comme une suite de caractères.</p>
</div>
<div class="paragraph">
<p>Par exemple, le format <em>texte brut</em> (<em>plain text</em> ) contient une suite de caractères.
Un document au format texte brut représente un contenu basique, sans mise en forme ni structure.
Il peut être affiché de multiples façons.
Exemple :</p>
</div>
<div class="listingblock">
<div class="title">sans mise en forme</div>
<div class="content">
<pre>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed non risus. Suspendisse lectus tortor, dignissim sit amet, adipiscing nec, ultricies sed, dolor. Cras elementum ultrices diam. Maecenas ligula massa, varius a, semper congue, euismod non, mi.</pre>
</div>
</div>
<div class="verseblock">
<div class="title">40 caractères par ligne</div>
<pre class="content">Lorem ipsum dolor sit amet, consectetur
 adipiscing elit. Sed non risus. Suspen
disse lectus tortor, dignissim sit amet
, adipiscing nec, ultricies sed, dolor.
 Cras elementum ultrices diam. Maecenas
 ligula massa, varius a, semper congue
, euismod non, mi.</pre>
</div>
<div class="quoteblock">
<div class="title">adaptatif</div>
<blockquote>
Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed non risus. Suspendisse lectus tortor, dignissim sit amet, adipiscing nec, ultricies sed, dolor. Cras elementum ultrices diam. Maecenas ligula massa, varius a, semper congue, euismod non, mi.
</blockquote>
</div>
<div class="paragraph">
<p>Si le texte contient des méta-données pour le mettre en forme,
ajouter de l&#8217;information (des notes, des renvois, etc.),
ou le structurer, alors ce n&#8217;est plus du texte brut.
Il est toujours humainement lisible, mais son interprétation n&#8217;est plus aussi immédiate :</p>
</div>
<div class="listingblock">
<div class="title">HTML</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-html hljs" data-lang="html">&lt;html&gt;&lt;head&gt;
&lt;title&gt;Lorem ipsum dolor sit amet, consectetur adipiscing elit.&lt;/title&gt;
&lt;body&gt;Sed non risus. Suspendisse lectus tortor, dignissim sit amet,
adipiscing nec, ultricies sed, dolor. Cras elementum ultrices diam.
Maecenas ligula massa, varius a, semper congue, euismod non,
mi.&lt;/body&gt;&lt;/html&gt;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">INI</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-ini hljs" data-lang="ini">; Last modified 15 July 2010 by Juan Dona
[owner]
name=juan dona
organization=cablage ideal

[database]
; use IP address in case network name resolution is not working
server=192.0.2.42
port=143
file = "acme payroll.dat"</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">JSON</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
  "glossary": {
    "title": "example glossary",
    "GlossDiv": {
      "title": "S",
      "GlossList": {
        "GlossEntry": {
          "ID": "SGML",
          "SortAs": "SGML",
          "GlossTerm": "Standard Generalized Markup Language",
          "Acronym": "SGML",
          "Abbrev": "ISO 8879:1986",
          "GlossDef": {
            "para": "A meta-markup language, used to create markup languages such as DocBook.",
            "GlossSeeAlso": ["GML", "XML"]
          },
        "GlossSee": "markup"
        }
      }
    }
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>A l&#8217;extrême, une donnée textuelle peut être humainement incompréhensible, bien que toujours humainement lisible.
Le format est <em>ouvert</em> si la façon d&#8217;interpréter les données est connue, publique, normalisée.
Par exemple, HTML est un format ouvert.
Dans le cas contraire, le format est <em>fermé</em> (ou <em>opaque</em>).
Il est utilisable seulement par les logiciels qui savent l&#8217;interpréter.</p>
</div>
</div>
<div class="sect2">
<h3 id="_fichier_texte"><a class="anchor" href="#_fichier_texte"></a>1.2. Fichier texte</h3>
<div class="paragraph">
<p>Un fichier est une suite d&#8217;octets.
S&#8217;il s&#8217;agit d&#8217;un texte en anglais, alors chaque octet est un caractère.
Sinon c&#8217;est plus compliqué.</p>
</div>
<div class="paragraph">
<p><code>f=open(file=filename, mode="r")</code>
ouvre un fichier texte en lecture,
opération obligatoire avant de pouvoir accéder à son contenu.
La valeur par défaut de <code>mode</code> étant <code>r</code>, on peut donc écrire simplement <code>f=open(filename)</code>.
f est un objet qui contient divers attributs nécessaires à la gestion efficace de ce fichier :
la position courante dans le fichier,
un <em>tampon</em> (<em>buffer</em>) pour optimiser les transferts,
ainsi que divers indicateurs
(le fichier est-il ouvert ou fermé, est-il en erreur, etc.).</p>
</div>
<div class="paragraph">
<p><code>f=open(file=filename, mode="w")</code>
ouvre un fichier texte en écriture.
Si le fichier existe déjà, il est vidé au préalable.</p>
</div>
<div class="paragraph">
<p><code>f=open(file=filename, mode="a")</code>
ouvre un fichier texte en écriture.
Si le fichier existe déjà, le contenu qui lui est destiné est ajouté au contenu actuel.</p>
</div>
<div class="paragraph">
<p><code>f.close()</code> ferme le fichier, et libère les ressources allouées par <code>open</code>,
c&#8217;est pourquoi il est important de ne pas l&#8217;oublier (sous peine de fuites mémoire).
Toutes les données écrites sont assurément dans le fichier après le <code>close</code>,
car le buffer est purgé à ce moment.
Sans <code>close</code>, rien n&#8217;est moins sûr.</p>
</div>
<div class="sect3">
<h4 id="_lecture_dun_fichier_texte"><a class="anchor" href="#_lecture_dun_fichier_texte"></a>1.2.1. Lecture d&#8217;un fichier texte</h4>
<div class="ulist">
<ul>
<li>
<p>La méthode <code>read</code> renvoie n octets (tous par défaut) du fichier à partir de la position courante
(et la position courante avance d&#8217;autant).</p>
</li>
<li>
<p>La méthode <code>readline</code> renvoie la ligne du fichier (et la ligne suivante devient la ligne courante).</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/readline.png" alt="readline" width="500">
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>La méthode <code>readlines</code> renvoie n lignes du fichier (toutes par défaut) à partir de la position courante (et la position courante avant d&#8217;autant).</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/readlines.png" alt="readlines" width="500">
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Lorsque que le développeur demande à lire n caractères, en réalité un bloc de données complet est  chargé depuis le disque vers la mémoire (dans le buffer), qui est ensuite exploité au fur et à mesure des demandes.
Le système anticipe donc les demandes :
il est plus performant de lire un bloc de données contigues sur le disque d&#8217;un seul coup,
plutôt que de s&#8217;y reprendre à plusieurs reprises.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Exemple de lecture ligne par ligne d&#8217;un fichier :</p>
</div>
<div class="listingblock">
<div class="title">version gourmande en mémoire</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">il=0
f=open("/etc/passwd","r")
for line in f.readlines(): <i class="conum" data-value="1"></i><b>(1)</b>
    il += 1
    print(f"{il:03d}: {line}", end="")
f.close()</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>parcours d&#8217;une liste</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Cette version charge tout le contenu du fichier en mémoire.
Pour éviter cela, mieux vaut écrire :</p>
</div>
<div class="listingblock">
<div class="title">version économe en mémoire</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">il = 0
f=open("/etc/passwd","r")
for line in f: <i class="conum" data-value="1"></i><b>(1)</b>
    il += 1
    print(f"{il:03d}: {line}", end="")
f.close()</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>récupère <code>line</code> via un itérateur</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>car ici c&#8217;est un itérateur qui renvoie successivement chaque ligne,
On ne charge pas l&#8217;intégralité des données en mémoire,
donc on peut traiter des fichiers plus volumineux que la mémoire disponible.</p>
</div>
<div class="paragraph">
<p>Une version équivalente en plus compact :</p>
</div>
<div class="listingblock">
<div class="title">version plus pythonique</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">il = 0
with open("/etc/passwd","r") as f:
  for line in f:
    il += 1
    print(f"{il:03d}: {line}", end="")
<i class="conum" data-value="1"></i><b>(1)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>ici (à la sortie du <code>with</code>), le <code>close</code> est réalisé automatiquement.</td>
</tr>
</table>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
Dans toutes ces versions, le saut de ligne est mémorisé dans <code>line</code>, d&#8217;où le <code>end=""</code>.
Et attention aux spécificités de chaque OS :
sous Unix, la marque de fin de ligne est <code>\n</code>, sous Windows c&#8217;est <code>\r\n</code>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Pour lire un fichier caractère par caractère :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">ic = 0
with open("/etc/passwd","r") as f:
  while True:
    if ic%40==0:
      print(f"\n{ic:06d}: ", end="")
    c = f.read(1)    <i class="conum" data-value="1"></i><b>(1)</b>
    if not c:
      break
    print(f"{c if c.isprintable() else '■'}", end="")
    ic += 1</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>lecture d&#8217;un caractère</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_ecriture_dun_fichier_texte"><a class="anchor" href="#_ecriture_dun_fichier_texte"></a>1.2.2. Ecriture d&#8217;un fichier texte</h4>
<div class="listingblock">
<div class="title">écrire une liste de string</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">l = [ "un\n", "deux\n", "trois\n", "quatre\n" ]

f=open("/tmp/test","w")
f.writelines(l)
f.close()</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">écrire string par string</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">l = [ "un", "deux", "trois", "quatre" ]

f=open("/tmp/test","w")
for line in l:
  print(line, file=f)        # ou bien : f.write(line+"\n")
f.close()</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">version plus pythonique</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">l = [ "un", "deux", "trois", "quatre" ]

with open("/tmp/test","w") as f:
  for line in l:
    print(line, file=f)        # ou bien : f.write(line+"\n")</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>print(line, file=f, flush=True)</code>
écrit la ligne dans le fichier f, puis
force l&#8217;écriture immédiate du buffer sur le support physique.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_données_sur_le_web"><a class="anchor" href="#_données_sur_le_web"></a>1.3. Données sur le web</h3>
<div class="paragraph">
<p>La ressource issue du web est récupérée intégralement en une requête.
Elle peut ensuite être parcourue de différentes façons.</p>
</div>
<div class="listingblock">
<div class="title">entièrement</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">import urllib.request

url = 'https://math.univ-angers.fr/~jaclin/lorem.txt'

with urllib.request.urlopen(url) as response:
  print(response.readlines())</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">ligne par ligne</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">url = 'https://math.univ-angers.fr/~jaclin/lorem.txt'

il = 0
with urllib.request.urlopen(url) as response:
  for line in response:
    il += 1
    print(f"{il:03d}: {line}")</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">caractère par caractère</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">import urllib.request
url = 'https://math.univ-angers.fr/~jaclin/lorem.txt'

ic = 0
with urllib.request.urlopen(url) as response:
  while True:
    if ic%40==0:
      print(f"\n{ic:06d}: ", end="")
    c = response.read(1).decode() <i class="conum" data-value="1"></i><b>(1)</b>
    if not c:
      break
    print(f"{c if c.isprintable() else '■'}", end="")
    ic += 1</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>read renvoie un <code>byte</code>, <code>decode</code> le transforme en caractère</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_données_non_textuelles"><a class="anchor" href="#_données_non_textuelles"></a>2. Données non textuelles</h2>
<div class="sectionbody">
<div class="paragraph">
<p>L&#8217;interprétation de fichiers images, vidéo ou audio, etc. est du ressort des programmes, pas des humains.
Ce sont des données numériques.
En mémoire vive, elles sont représentées sous forme binaire, performance oblige.
Pour les enregistrer dans un fichier, le plus  efficace consiste à recopier
en bloc la mémoire sur disque.
Mais dans ce cas, on obtient un fichier illisible par un humain sans super-pouvoir.</p>
</div>
<div class="paragraph">
<p>Pourtant, dans certains cas, on peut vouloir disposer d&#8217;un fichier de nombres lisible par un humain (sans super-pouvoir).</p>
</div>
<div class="paragraph">
<p>Ecrire un nombre dans un fichier texte suppose de le traduire en une suite de chiffres.
Par exemple, écrire l&#8217;entier représenté par les 4 octets 00 00 00 00
revient à écrire le caractère <code>'0'</code>
(puisque 00 00 00 00 est la représentation binaire de 0).
De même, écrire l&#8217;entier représenté par les 4 octets 255 255 255 255
consiste à écrire les 5 caractères <code>'6'</code>, <code>'5'</code>, <code>'5'</code>, <code>'3'</code>, <code>'5'</code>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_fichier_binaire"><a class="anchor" href="#_fichier_binaire"></a>3. Fichier binaire</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_exemple_pour_des_entiers"><a class="anchor" href="#_exemple_pour_des_entiers"></a>3.1. Exemple pour des entiers</h3>
<div class="listingblock">
<div class="title">création d&#8217;un fichier binaire</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">with open("/tmp/f.bin", "wb") as f: <i class="conum" data-value="1"></i><b>(1)</b>
  for i in range(32768):
    f.write(i.to_bytes(2,"little"))</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>noter le <code>'b'</code></td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="title">lecture de ce fichier binaire</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">with open("/tmp/f.bin", "rb") as f:
    while True:
      i = f.read(2)
      if len(i)&lt;2: break
      print(int.from_bytes(i,"little"), end=" ")</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_cas_général"><a class="anchor" href="#_cas_général"></a>3.2. Cas général</h3>
<div class="paragraph">
<p>Les exemples précédents utilisent  les méthodes <code>from_bytes()</code> et <code>to_bytes()</code> du type <em>int</em> .
Ils ne sont pas généralisables à d&#8217;autres types numériques.</p>
</div>
<div class="paragraph">
<p>Le module <code>struct</code> convertit les types numériques et au-delà,
dans des formats interopérables,
ce qui est indispensable pour lire des données binaires issues de tous horizons,
comme des données générées par de l&#8217;instrumentation (capteurs, séquenceurs du génome, etc.),
 des programmes non Python, etc.</p>
</div>
<div class="paragraph">
<p>Soit l&#8217;exercice consistant à socker les termes de la suite de Fibonacci inférieurs à une certaine valeur dans un fichier binaire.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Version 1</dt>
<dd>
<p>Pour l&#8217;écriture, on calcule un terme et on l&#8217;écrit dans la foulée :</p>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">import struct

last = 100000
a = b = 1
with open("/tmp/fib1.bin", "wb") as f:
  f.write(struct.pack("i",a))
  while (b&lt;last):
    f.write(struct.pack("i",b))
    a,b = b,a+b</code></pre>
</div>
</div>
<div class="paragraph">
<p>Pour la relecture, ne connaissant pas le nombre d&#8217;entiers dans le fichier,
on récupérera les entiers un par un.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Version 2</dt>
<dd>
<p>On calcule les termes et on les garde en mémoire.
On écrit ensuite dans le fichier le nombre de termes,
puis les termes eux-mêmes :</p>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">import struct

l = []
last = 100000
a = b = 1
l.append(a)

while (b&lt;last):
  l.append(b)
  a,b = b,a+b
nb = len(l)

with open("/tmp/fib2.bin", "wb") as f:
  f.write(struct.pack("i",nb))
  f.write(struct.pack(f"{nb}i",*l))</code></pre>
</div>
</div>
<div class="paragraph">
<p>Connaissant le nombre d&#8217;entiers du fichier, on pourra les relire d&#8217;un seul coup.</p>
</div>
</div>
</div>
</div>
</article>
  </div>
</main>
</div>
<footer class="footer">
  <p class="center">
  <span style="font-size: 0.9em;">
    <a href="https://jacquelincharbonnel.github.io/">Jacquelin Charbonnel</a>
    <!-- &nbsp; &mdash; &nbsp; -->
    &nbsp; &nbsp;
    &copy;Creative Commons BY-NC-SA 4.0
  </span>
  </p>
</footer>

<script>
var myDate = new Date(document.lastModified);
myNewDate = new Intl.DateTimeFormat(
            undefined,
            {year: "numeric", month: "long", day: "numeric", hour: "2-digit", minute: "2-digit"}
        )
        .format(myDate).replace(/\./g, '-');
document.getElementById("lastmodify").innerHTML = myNewDate ;
</script>

<script id="site-script" src="../../../_/js/site.js" data-ui-root-path="../../../_"></script>
<script async src="../../../_/js/vendor/highlight.js"></script>
  </body>
</html>
