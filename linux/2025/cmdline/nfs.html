<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>NFS :: Supports</title>
    <link rel="canonical" href="https://jacquelincharbonnel.github.io/supports/linux/2025/cmdline/nfs.html">
    <meta name="generator" content="Antora 3.1.14">
    <link rel="stylesheet" href="../../../_/css/site.css">
<!-- reference des feuilles de styles supplémentaires -->
<link rel="stylesheet" href="../../../_/css/layout.css">
<link rel="stylesheet" href="../../../_/css/content.css">

  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://jacquelincharbonnel.github.io/supports">Supports</a>
  <!-- suppression du burger du bandeau
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
-->      
    </div>
<!-- suppression des boutons du bandeau
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
      </div>
    </div>
-->
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="linux" data-version="2025">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <button class="nav-menu-toggle" aria-label="Toggle expand/collapse all" style="display: none"></button>
    <h3 class="title"><a href="../index.html">Linux</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../context/overview.html">Le contexte</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../context/news.html">L&#8217;actualité</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="priseenmain.html">Utiliser le système</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="fs.html">Système de fichiers</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="shell.html">Le shell</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="proc.html">Processus</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="redirect.html">Redirection et pipes</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="remote.html">Connexions distantes</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="script.html">Script shell</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="cron.html">Planifier les tâches</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="admin.html">Gérer le système</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="su.html">Privilèges</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="appli.html">Les applications</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="admfs.html">L&#8217;espace de stockage</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="user.html">Les comptes</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="services.html">Les services</a>
<ul class="nav-list">
  <li class="nav-item is-current-page" data-depth="3">
    <a class="nav-link" href="nfs.html">NFS</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="sshd.html">sshd</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Linux</span>
    <span class="version">2025</span>
  </div>
  <ul class="components">
    <li class="component">
      <div class="title"><a href="../../../C/2023/index.html">C</a></div>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../C/2023/index.html">2023</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <div class="title"><a href="../../../concurrence/2024/index.html">Concurrence</a></div>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../concurrence/2024/index.html">2024</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <div class="title"><a href="../../../datatext/2023/index.html">DataText</a></div>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../datatext/2023/index.html">2023</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <div class="title"><a href="../../../json/2023/index.html">JSON</a></div>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../json/2023/index.html">2023</a>
        </li>
      </ul>
    </li>
    <li class="component is-current">
      <div class="title"><a href="../index.html">Linux</a></div>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../index.html">2025</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <div class="title"><a href="../../../python_objet/2024/index.html">Python objet</a></div>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../python_objet/2024/index.html">2024</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <div class="title"><a href="../../../reseau_baba/2025/index.html">Réseau</a></div>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../reseau_baba/2025/index.html">2025</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <div class="title"><a href="../../../supports/index.html">Supports</a></div>
    </li>
    <li class="component">
      <div class="title"><a href="../../../xml/2023/index.html">XML</a></div>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../xml/2023/index.html">2023</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../../../supports/index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../index.html">Linux</a></li>
    <li><a href="admin.html">Gérer le système</a></li>
    <li><a href="services.html">Les services</a></li>
    <li><a href="nfs.html">NFS</a></li>
  </ul>
</nav>
<!-- supression de "edit this page"
  <div class="edit-this-page"><a href="file:///home/jaclin/antora_components/linux/./modules/cmdline/pages/nfs.adoc">Edit this Page</a></div>
-->
</div>
  <!-- ajout de la date de modification -->
     <div class="lastmodify"> dernière modification : 2025 </div>
  <!-- fin ajout -->
  <div class="content">
<aside class="toc sidebar" data-title="Plan" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">NFS</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>NFS (Network File System) est un service réseau permettant de partager une arborescence de répertoires
entre divers équipements.
Ce service met en relation des serveurs NFS qui exportent des arborescences de répertoires
et des clients qui <em>montent</em> les répertoires exportés.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_le_serveur_nfs"><a class="anchor" href="#_le_serveur_nfs"></a>1. Le serveur NFS</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Mettre en place un serveur NFS demande :</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>d&#8217;installation les packages nécessaires</p>
</li>
<li>
<p>de définir les répertoires à exporter</p>
</li>
<li>
<p>de démarrer le service</p>
</li>
<li>
<p>d&#8217;adapter le cas échéant les règles du firewall</p>
</li>
</ol>
</div>
<div class="sect2">
<h3 id="_installer_les_packages"><a class="anchor" href="#_installer_les_packages"></a>1.1. Installer les packages</h3>
<div class="listingblock">
<div class="title">sur redhat-like</div>
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs"># dnf install nfs-utils</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">sur debian-like</div>
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs"># apt-get upgrade
# apt-get install nfs-kernel-server</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_définir_les_exports"><a class="anchor" href="#_définir_les_exports"></a>1.2. Définir les exports</h3>
<div class="paragraph">
<p>Chaque répertoire exporté doit être listé dans le fichier <code>/etc/exports</code>.
La syntaxe est stricte : un répertoire par ligne, pas d&#8217;espace superflu, etc.
Exemples de fichier <code>/etc/exports</code> :</p>
</div>
<div class="ulist">
<ul>
<li>
<p>pour exporter un répertoire <code>/public</code> en read+write pour tout équipement</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">/public *(rw)</code></pre>
</div>
</div>
</li>
<li>
<p>pour exporter 2 répertoires, l&#8217;un en read+write, l&#8217;autre en read-only, pour tout équipement</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">/public *(rw)
/public2 *(ro)</code></pre>
</div>
</div>
</li>
<li>
<p>1 répertoire exporté en read+write pour <code>192.168.1.1</code>, et en read-only pour <code>192.168.1.2</code> :</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">/public 192.168.1.1(rw) 192.168.1.2(ro)</code></pre>
</div>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>Lorsque que le fichier <code>/etc/exports</code> est correctement rempli,
il est nécessaire de lancer la commande ci-dessous pour que la modification soit prise en compte :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs"># exportfs -rv</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_démarrer_le_service"><a class="anchor" href="#_démarrer_le_service"></a>1.3. Démarrer le service</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs"># systemctl start nfs-server</code></pre>
</div>
</div>
<div class="paragraph">
<p>Pour que le démarrage soit effectif à chaque reboot :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs"># systemctl enable nfs-server</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_adapter_le_firewall"><a class="anchor" href="#_adapter_le_firewall"></a>1.4. Adapter le firewall</h3>
<div class="paragraph">
<p>Si un firewall tourne sur le serveur, alors il est nécessaire d&#8217;ajuster les règles de filtrage
pour autoriser les clients NFS à accéder aux partages.</p>
</div>
<div class="paragraph">
<p>Il se peut que l&#8217;installation du package adapte automatiquement les règles du firewall.
Sinon, pour tester l&#8217;exportation sans se poser de question, on peut (exceptionnellement) arrêter le firewall.
Sur Redhat, on arrête le firewall par :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs"># systemctl stop firewalld</code></pre>
</div>
</div>
<div class="paragraph">
<p>Pour désactiver définitivement le firewall (déconseillé) :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs"># systemctl disable firewalld</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_le_client_nfs"><a class="anchor" href="#_le_client_nfs"></a>2. Le client NFS</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Monter un répertoire est une opération globale au client, qui affecte tous les utilisateurs.
Il doit donc être réalisé par <code>root</code>.
Par exemple, monter le répertoire <code>/public</code> exporté par 192.168.1.3 sur l&#8217;équipement local se fait par la commande :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs"># mount 192.168.1.3:/public /mnt</code></pre>
</div>
</div>
<div class="paragraph">
<p>La commande ci-dessus <em>accroche</em> le répertoire /public du serveur distant <em>sur</em> le répertoire <code>/mnt</code> de l&#8217;équipement local.
Si <code>/mnt</code> contient des fichiers, ceux-ci seront masqués tant que le montage sera actif.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Un équipement donné peut monter un nombre quelconque de répertoires depuis un nombre quelconque de serveurs,
et en exporter lui-même d&#8217;autres.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Pour <em>démonter</em> le répertoire :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs"># umount /mnt</code></pre>
</div>
</div>
<div class="paragraph">
<p>Le fichier <code>/etc/fstab</code> liste tous les montages qui doivent se réaliser automatiquement au boot.
Donc si l&#8217;on veut qu&#8217;un montage donné soit automatique à chaque boot,
il faut ajouter une ligne dans <code>/etc/fstab</code> :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">192.168.1.3:/public /mnt nfs rw 0 0</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Le fichier <code>/etc/fstab</code> contient tous les montages souhaités, pas seulement les montages NFS.
Il contient notamment le montage de toutes les partitions locales qui constituent le filesystem complet.
</td>
</tr>
</table>
</div>
</div>
</div>
</article>
  </div>
</main>
</div>
<footer class="footer">
  <p class="center">
  <span style="font-size: 0.9em;">
    <a href="https://jacquelincharbonnel.github.io/">Jacquelin Charbonnel</a>
    <!-- &nbsp; &mdash; &nbsp; -->
    &nbsp;
    &copy;Creative Commons BY-NC-SA 4.0
  </span>
  </p>
</footer>

<script>
var myDate = new Date(document.lastModified);
myNewDate = new Intl.DateTimeFormat(
            undefined,
            {year: "numeric", month: "long", day: "numeric", hour: "2-digit", minute: "2-digit"}
        )
        .format(myDate).replace(/\./g, '-');
document.getElementById("lastmodify").innerHTML = myNewDate ;
</script>

<script id="site-script" src="../../../_/js/site.js" data-ui-root-path="../../../_"></script>
<script async src="../../../_/js/vendor/highlight.js"></script>
  </body>
</html>
